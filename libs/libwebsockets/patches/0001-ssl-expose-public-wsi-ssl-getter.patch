From 15fe249ff1796ccab203df4f7e94e562a86ef3c9 Mon Sep 17 00:00:00 2001
From: Denis Osvald <denis.osvald@sartura.hr>
Date: Mon, 12 Dec 2016 16:27:56 +0100
Subject: [PATCH 1/3] ssl expose public wsi->ssl getter

Signed-off-by: Denis Osvald <denis.osvald@sartura.hr>
---
 lib/libwebsockets.c |  8 ++++++++
 lib/libwebsockets.h | 11 +++++++++++
 2 files changed, 19 insertions(+)

diff --git a/lib/libwebsockets.c b/lib/libwebsockets.c
index f8c879a..40acd8b 100755
--- a/lib/libwebsockets.c
+++ b/lib/libwebsockets.c
@@ -1208,6 +1208,14 @@ lws_is_ssl(struct lws *wsi)
 #endif
 }
 
+#ifdef LWS_OPENSSL_SUPPORT
+LWS_VISIBLE SSL*
+lws_get_ssl(struct lws *wsi)
+{
+	return wsi->ssl;
+}
+#endif
+
 LWS_VISIBLE int
 lws_partial_buffered(struct lws *wsi)
 {
diff --git a/lib/libwebsockets.h b/lib/libwebsockets.h
index 5d05ee4..100a040 100644
--- a/lib/libwebsockets.h
+++ b/lib/libwebsockets.h
@@ -3839,6 +3839,17 @@ lws_is_ssl(struct lws *wsi);
  */
 LWS_VISIBLE LWS_EXTERN int
 lws_is_cgi(struct lws *wsi);
+
+#ifdef LWS_OPENSSL_SUPPORT
+/**
+ * lws_get_ssl() - Return wsi's SSL context structure
+ * \param wsi:	websocket connection
+ *
+ * Returns pointer to the SSL library's context structure
+ */
+LWS_VISIBLE LWS_EXTERN SSL*
+lws_get_ssl(struct lws *wsi);
+#endif
 ///@}
 
 
-- 
2.11.0

